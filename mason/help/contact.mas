<%args>
$website_name => ''
$captcha_public_key
</%args>

<& "/page/page_title.mas", title => "Contact $website_name" &>

<div class="container-fluid">
    <div class="well">

% #The form
<% $ENV{REMOTE_ADDR} %>
<% ##$captcha_public_key %>
  <form class="form-horizontal" role="form" method="POST" action="/contact/submit" name="contactForm">

% #Uses Perl to print out the fields with similar HTML tags
<%perl>
my $infoNeeded = ["name", "email", "subject", ];
my $defaultVal = {"name" => $name, "email" => $email, "subject" => $subject};
</%perl>

% foreach my $info_category (@$infoNeeded) {
    <div class="form-group">
      <label class="col-sm-2 control-label"><% ucfirst $info_category %>* : 

% # If user did not fill out a field and submitted the form, then it will 
% # show in red letters above the field this field is needed above it. 
% # Otherwise, the form is filled out normally.
% unless ($filled{$info_category}) {
      <p style = "color:red; font-size: 10px;"><% ucfirst $info_category %> is required.</p> 
% }
      </label>
      <div class="col-sm-10">
        <input type="text" class="form-control" value="<% $$defaultVal{$info_category} |h%>" name="<% $info_category %>"></input>
      </div>
    </div>
% }

    <div class="form-group">
      <label class="col-sm-2 control-label">Body* : 

% unless ($filled{body}) {
      <p style = "color:red; font-size: 10px;">Message body is required.</p>
% }
      </label>
      <div class="col-sm-10">
        <textarea rows="12" class="form-control" name="body"><% $body |h%></textarea>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label">What is <br/><% $contact_form_human_question %>?* : 

% if (!$contact_form_human_answer_correct) { 
<font style = "color:red; font-size: 10px;" ><br/>
% if (!$contact_form_human_answer) { 
Proving that you are a human being is required.<br /></font>
% } else { 
Either you are not human - or you are not very good at math! ;-)<br /></font>
%    }
% }
      </label>
      <div class="col-sm-10">
        <input type="text" class="form-control" value="" name="contact_form_human_answer"></input>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label"></label>
      <div class="col-sm-10">
        <h5 valign="middle" style="color:red; font-size:90%; font-style:italic;">Fields Marked With <% '"*"' |h %> Are Required.</h5>
      </div>
    </div>
    <div class="form-group">
      <label class="col-sm-2 control-label"></label>
      <div class="col-sm-10">
        <script type="text/javascript"
     	  src="https://www.google.com/recaptcha/api/challenge?k=<% $captcha_public_key %>">
        </script>
  	<noscript>
     	  <iframe src="https://www.google.com/recaptcha/api/noscript?k=<% $captcha_public_key %>" height="300" width="500" frameborder="0"></iframe><br>
     	  <textarea name="recaptcha_challenge_field" rows="3" cols="40"></textarea>
     	  <input type="hidden" name="recaptcha_response_field" value="manual_challenge">
  	</noscript>
      </div>
    </div>
    <hr>
    <button style="float:right" type="submit" class="btn btn-primary btn-lg">Submit</button>
    <br/><br/>

  </form>
  </div>
  
  <br/>
  <h2>Contact Us</h2>
  <br/>
  <table class="table table-hover table-bordered">
     <tbody>
      <tr>
        <td><b>Email</b></td>
	<td>Note that the contact email address <% $email_address_to_display %> has been deactivated due to extreme levels of spam. <br/>Use this contact form instead.</td>
      </tr>
      <tr>
        <td><b>Mailing Address</b></td>
	<td>Sol Genomics Network<br />
	Boyce Thompson Institute for Plant Research<br />
	Room 221<br />
	Tower Road<br />
	Ithaca, NY 14853<br />
	USA<br /></td>
      </tr>
      <tr>
        <td><b>Phone</b></td>
        <td>(607) 255-6557</td>
      </tr>
      <tr>
        <td><b>Mailing List</b></td>
        <td>To stay informed of developments at SGN you can subscribe to our <a href="http://rubisco.sgn.cornell.edu/mailman/listinfo/sgn-announce/">mailing list</a>. <br/>This is a low-volume list (usually no more than 2 messages per month).</td>
      </tr>
    </tbody>
  </table>

  </div>   
</div>


<%args>
  $name                     => ''
  $email                    => ''
  $subject                  => ''
  $body                     => ''
  %filled                   => (name => 1, email => 1, subject => 1, body => 1)
  $email_address_to_display => ''
  $contact_form_human_answer => ''
  $contact_form_human_question => ''
  $contact_form_human_answer_correct => 0
</%args>
<%once>
  use CXGN::Page::FormattingHelpers 'info_table_html';
</%once>
